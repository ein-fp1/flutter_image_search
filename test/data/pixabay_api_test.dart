import 'package:flutter_image_search/data/pixabay_api.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:http/http.dart' as http;
import 'package:mockito/annotations.dart';
import 'package:mockito/mockito.dart';

import 'pixabay_api_test.mocks.dart';

@GenerateMocks([http.Client])
void main() {
  test('Pixabay Response Check', () async {
    final api = PixabayApi();

    final client = MockClient();

    when(client.get(Uri.parse(
            '${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=flower&image_type=photo')))
        .thenAnswer((_) async => http.Response(fakeJsonBody, 200));

    final result = await api.fetch('flower', client: client);

    expect(result.first.id, 276014);

    verify(client.get(Uri.parse(
        '${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=flower&image_type=photo')));
  });
}

String fakeJsonBody =
    """{"total":232844,"totalHits":500,"hits":[{"id":276014,"pageURL":"https://pixabay.com/photos/tree-flowers-meadow-tree-trunk-276014/","type":"photo","tags":"tree, flowers, meadow","previewURL":"https://cdn.pixabay.com/photo/2014/02/27/16/10/tree-276014_150.jpg","previewWidth":150,"previewHeight":95,"webformatURL":"https://pixabay.com/get/g4582b6f3354c4d79160ed75cdfba0cd0952b884fce3529a12e388610bff1be6069ce64c1412debbd3fef8461f617c251_640.jpg","webformatWidth":640,"webformatHeight":407,"largeImageURL":"https://pixabay.com/get/g3d076defb6099ab3b68b2852d610f59af52cf2685b6c3a20720d7d891ecea388b137645958dd0f23aa6f97f9c8add09cd9749446547c4d21121f5ab0695c3ef8_1280.jpg","imageWidth":4090,"imageHeight":2602,"imageSize":2134495,"views":2747574,"downloads":1088659,"collections":4056,"likes":5268,"comments":1561,"user_id":1107275,"user":"Larisa-K","userImageURL":"https://cdn.pixabay.com/user/2015/06/13/06-38-56-116_250x250.jpg"},{"id":324175,"pageURL":"https://pixabay.com/photos/pink-cherry-blossoms-flowers-branch-324175/","type":"photo","tags":"pink, cherry blossoms, flowers","previewURL":"https://cdn.pixabay.com/photo/2014/04/14/20/11/pink-324175_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gcec8e1e4d74d61895d26fe78e0c8266b3328a03f7070d53804289ea5f5466a7f9c5371ccee66c64651396af139871f03_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g34afaf149f310b79370afb05269b59b951e98727a5fcde8e433e55f5d0bd0f69d2b4b249e8235691dd30b197de65ae5ea4664f60c3880d678e743586aee53bbd_1280.jpg","imageWidth":6000,"imageHeight":4000,"imageSize":2613829,"views":3505044,"downloads":1731386,"collections":3861,"likes":4878,"comments":1190,"user_id":2,"user":"Hans","userImageURL":"https://cdn.pixabay.com/user/2019/01/29/15-01-52-802_250x250.jpg"},{"id":19830,"pageURL":"https://pixabay.com/photos/garden-flowers-butterfly-19830/","type":"photo","tags":"garden, flowers, butterfly","previewURL":"https://cdn.pixabay.com/photo/2012/03/01/00/55/garden-19830_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g82b58621e07814a64f4a6234db773fcadff43b9cc02c43ecd711ab3b039e26135c28b601c7d3abd5a34457ad8b8a845f_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/ge6b8504b63997bc79cf663425e4a439400d69f41f83d1cb86fa1bd85039eefb1431874476875645d9b04f0fa2b9ba4a6_1280.jpg","imageWidth":2144,"imageHeight":1424,"imageSize":668020,"views":1871340,"downloads":547665,"collections":3083,"likes":3832,"comments":762,"user_id":1107275,"user":"Larisa-K","userImageURL":"https://cdn.pixabay.com/user/2015/06/13/06-38-56-116_250x250.jpg"},{"id":2031539,"pageURL":"https://pixabay.com/photos/mountain-landscape-steps-stones-2031539/","type":"photo","tags":"mountain landscape, steps, stones","previewURL":"https://cdn.pixabay.com/photo/2017/02/01/22/02/mountain-landscape-2031539_150.jpg","previewWidth":150,"previewHeight":84,"webformatURL":"https://pixabay.com/get/gd2bf00658b858a1605c854a6bed611546a01fb0cec00db48d82fab6e51f8fad73c883e1c4dd89f7167a9ba4249706fc491a86946c60d1def65e4a0b7a75d41bc_640.jpg","webformatWidth":640,"webformatHeight":360,"largeImageURL":"https://pixabay.com/get/ge28195650ba36918557d34aaf3981094c697aecbe2bb1721df56ea0252979a771213597251a854bb92b89a01227e70a879c1786ee82554646cc3a065cf149f53_1280.jpg","imageWidth":5184,"imageHeight":2916,"imageSize":5575510,"views":1916263,"downloads":1382580,"collections":3118,"likes":3511,"comments":541,"user_id":4384506,"user":"kinkate","userImageURL":"https://cdn.pixabay.com/user/2022/01/21/15-24-15-855_250x250.jpg"},{"id":1127666,"pageURL":"https://pixabay.com/photos/butterflies-flowers-pollinate-1127666/","type":"photo","tags":"butterflies, flowers, pollinate","previewURL":"https://cdn.pixabay.com/photo/2016/01/08/11/57/butterflies-1127666_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gd04b2f622de4e43df49ca4bea9b13b0a69f8984799b9c01e6815742cd4c4d1ce60d92d861b37f78df7cf43bd1f58b40bd36780711a726890d2194a65f5aaca84_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gdddf192519feac143c7bec344498a7191df95305ebcf8c82d03fb5aa3662a4227f0f84e03c8ec314889432ba76134aab2fa0d67e15eeaff5d8d54b5a416aaf56_1280.jpg","imageWidth":5184,"imageHeight":3456,"imageSize":2265939,"views":1864283,"downloads":944593,"collections":2716,"likes":3350,"comments":709,"user_id":1759589,"user":"ROverhate","userImageURL":"https://cdn.pixabay.com/user/2016/01/10/09-32-50-295_250x250.jpg"},{"id":174276,"pageURL":"https://pixabay.com/photos/poppies-field-sunset-dusk-sunlight-174276/","type":"photo","tags":"poppies, field, sunset","previewURL":"https://cdn.pixabay.com/photo/2013/08/20/15/47/poppies-174276_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g5f84bf47a7d4e45b2aaefa6bf2fb81f390698031cca9ed252a73b85157eb43c7be99e15b016a5a0b262a5c16ec36ae25_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g33be1b9b9261d49af04c3cb029c8f18c59308a34cec415869f908cfbe00c867fa4f226697283038f3aa9c6fe331d95bcbcc2ce9df32bad63924cba7f349ebf0c_1280.jpg","imageWidth":6000,"imageHeight":4000,"imageSize":2624110,"views":1833209,"downloads":936113,"collections":2592,"likes":2678,"comments":589,"user_id":49249,"user":"danigeza","userImageURL":""},{"id":1509956,"pageURL":"https://pixabay.com/photos/woman-field-sunlight-fashion-hat-1509956/","type":"photo","tags":"woman, field, sunlight","previewURL":"https://cdn.pixabay.com/photo/2016/07/11/15/43/woman-1509956_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g80ffefc8b0d061dfc8c26536c560470eab570d47cc219c3637cb61cf4a3dd08241668197f817deb23fac0333238e2cb37dea085bf0a0d330cfeace526a61b986_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g7d00cd714a1eebbde036a4971e97cdc850bbffd5c4b3fbcfb4c95c61ec560dc75b536022dcbb098f4d4cb1ac547cb371c18a8d38118b5a29ecc763d575fe2792_1280.jpg","imageWidth":5760,"imageHeight":3840,"imageSize":5088127,"views":1086525,"downloads":580185,"collections":2502,"likes":2458,"comments":400,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":729509,"pageURL":"https://pixabay.com/photos/hd-wallpaper-rose-flower-love-729509/","type":"photo","tags":"hd wallpaper, rose, flower","previewURL":"https://cdn.pixabay.com/photo/2015/04/19/08/32/rose-729509_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g99a3be4d26a638a96020fb757765c99b231b636e484ab5df37293613be36b49fdff36ed63f9af12edc9db6fdfcffd337_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/g2ce8325ddbe54c32e338740dd6cd65f27dd61e1f787447c0e7160c44673b2458979aa523796e41b3222c6479c884d0c9b719a73f5458d11f49c71ed25dac1b21_1280.jpg","imageWidth":1980,"imageHeight":1316,"imageSize":500190,"views":1539935,"downloads":608286,"collections":2313,"likes":2553,"comments":483,"user_id":909086,"user":"Bessi","userImageURL":"https://cdn.pixabay.com/user/2019/04/11/22-45-05-994_250x250.jpg"},{"id":729510,"pageURL":"https://pixabay.com/photos/marguerite-daisy-flower-white-729510/","type":"photo","tags":"marguerite, daisy, flower","previewURL":"https://cdn.pixabay.com/photo/2015/04/19/08/32/marguerite-729510_150.jpg","previewWidth":150,"previewHeight":97,"webformatURL":"https://pixabay.com/get/g11b470992f4536a3ae9d2c040cf523eb18ce1346f1ee94e058b61984126a4f8c0b09fc7966ce10b589b20781c45e6e25_640.jpg","webformatWidth":640,"webformatHeight":416,"largeImageURL":"https://pixabay.com/get/g27200cfdcf578d69451ef40f417f5941180fe70e258b6f0b73610da20cb181e0d1b49adbe3046bab70e8c18cdfc13af4e2c896deacdcc9c2a0ee1e201cbec7d1_1280.jpg","imageWidth":1980,"imageHeight":1289,"imageSize":307038,"views":1213755,"downloads":496764,"collections":2183,"likes":2515,"comments":648,"user_id":909086,"user":"Bessi","userImageURL":"https://cdn.pixabay.com/user/2019/04/11/22-45-05-994_250x250.jpg"},{"id":165819,"pageURL":"https://pixabay.com/photos/rose-flower-dew-dewdrops-droplets-165819/","type":"photo","tags":"rose, flower, dew","previewURL":"https://cdn.pixabay.com/photo/2013/07/21/13/00/rose-165819_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g9fa2d6cdd98363b6f9294357a11aa031d062dd2c6cda6e930811bbec91aa764abb04a76ff2a9aa0d8e55d26f035b2df4_640.jpg","webformatWidth":640,"webformatHeight":423,"largeImageURL":"https://pixabay.com/get/gf1e6a870ca7a868dbfb6d5d8cb3e1a702473d449f81c0484a7f04e696b1dffd1bb098fcfb4c7117cc0889947e2a7912f8100a9b7b77cbacf20259c0df08dd2c7_1280.jpg","imageWidth":4928,"imageHeight":3264,"imageSize":4000578,"views":1689888,"downloads":521495,"collections":2085,"likes":2572,"comments":632,"user_id":768,"user":"GLady","userImageURL":"https://cdn.pixabay.com/user/2014/07/12/21-19-34-426_250x250.jpg"},{"id":3140492,"pageURL":"https://pixabay.com/photos/flower-nature-flora-petal-summer-3140492/","type":"photo","tags":"flower, nature, flora","previewURL":"https://cdn.pixabay.com/photo/2018/02/08/22/27/flower-3140492_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/g5d62d525d61ecd6f06f75b547859bf67d1bf1aa99236f944f411ead0a47c1662bfb19c31600cd16a087ecc26c358b42ce8c6a265d4ee6f17a675f9c8df5f6aee_640.jpg","webformatWidth":640,"webformatHeight":427,"largeImageURL":"https://pixabay.com/get/g0c12dbe5da53d02bf11a83a7e05f38a15636203ab035d01b8b905e602d65c1d607541b41d7a53c7178aa9c4c76ddeb0d58147f50a9f8ebbca590f6258c520f7b_1280.jpg","imageWidth":5689,"imageHeight":3803,"imageSize":3511611,"views":2126053,"downloads":1439962,"collections":2290,"likes":2334,"comments":291,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":1205631,"pageURL":"https://pixabay.com/photos/lotus-flower-lily-pad-pond-1205631/","type":"photo","tags":"lotus, flower, lily pad","previewURL":"https://cdn.pixabay.com/photo/2016/02/17/19/08/lotus-1205631_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g0a802d344e831d209f5bf648839c5c9e4f2c2e07e859f9d5d780ed84826c4f05c45bbdbc21ee4c1e833d637fd38a0b0d7dfee21aa2446923361ae09c5cf26b25_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g92e1403f7126ebe7a720c7ca982526f21049cee3adc507971f7d95ae4849521d821b6127c84c3d03f151d533af07f5ea70443c057efd62fbfe5be10160981b40_1280.jpg","imageWidth":5184,"imageHeight":3456,"imageSize":4776299,"views":864223,"downloads":461410,"collections":2102,"likes":2379,"comments":423,"user_id":1785462,"user":"ha11ok","userImageURL":"https://cdn.pixabay.com/user/2022/04/21/13-05-33-554_250x250.png"},{"id":2295431,"pageURL":"https://pixabay.com/photos/bird-branch-perched-feathers-2295431/","type":"photo","tags":"bird, branch, perched","previewURL":"https://cdn.pixabay.com/photo/2017/05/08/13/15/bird-2295431_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g99e411c8dfa9f8d6988e6d0359df6190b8d5dc575e6300e39392b9b332b1b8914ef851c365fa1e0a06a4d36667e366e7c3b9e584419949f603d45a774309ea2b_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/geb543a972828bd5cda986a1b5fd482e4c2978f493d768798cc813c04cd548933ad0c2b360a1af41cf37bc18f502e6d09204e636573135d04a8b0f6ec4d2e0559_1280.jpg","imageWidth":4729,"imageHeight":3153,"imageSize":3124249,"views":929910,"downloads":597453,"collections":2209,"likes":2193,"comments":330,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":142876,"pageURL":"https://pixabay.com/photos/bouquet-flowers-roses-142876/","type":"photo","tags":"bouquet, flowers, roses","previewURL":"https://cdn.pixabay.com/photo/2013/07/02/22/20/bouquet-142876_150.jpg","previewWidth":150,"previewHeight":112,"webformatURL":"https://pixabay.com/get/g1f7f321ebe93374188d0432d78d24e627e7bd96d0066a7428ab589831551c9a2cd15c2d3ce0dfdc4235e0cd0c5c43711_640.jpg","webformatWidth":640,"webformatHeight":480,"largeImageURL":"https://pixabay.com/get/gb0df272b4fb47fabca60cd63ad7289917a68b7d7d935bb19347ea4cdf126181c456c253f47f0703919d541e9d7cb91f8dddad15c002d15759f75d6ee83900fa3_1280.jpg","imageWidth":3500,"imageHeight":2626,"imageSize":625554,"views":1408858,"downloads":434135,"collections":1798,"likes":1969,"comments":520,"user_id":5337,"user":"ArtTower","userImageURL":"https://cdn.pixabay.com/user/2019/07/27/00-12-46-447_250x250.jpg"},{"id":729512,"pageURL":"https://pixabay.com/photos/hd-wallpaper-nature-wallpaper-flower-729512/","type":"photo","tags":"hd wallpaper, nature wallpaper, flower","previewURL":"https://cdn.pixabay.com/photo/2015/04/19/08/33/flower-729512_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g3cca2ed6a8efa27cd2b56ade45c95b773e88d9c8edfa99b5e9a464379c7596652f46c16f5e2dc39d9aed5d79b0d6c77e_640.jpg","webformatWidth":640,"webformatHeight":423,"largeImageURL":"https://pixabay.com/get/g3a5b14eafaaebdd8e029dc5f35b3e5233de9ccef536a4c27664496ea34dc1483ac29fe0215d206068b4489a44148e3c91c1766420079f9d1db223b0e94364bf9_1280.jpg","imageWidth":1980,"imageHeight":1311,"imageSize":854653,"views":825883,"downloads":451592,"collections":1934,"likes":1896,"comments":336,"user_id":909086,"user":"Bessi","userImageURL":"https://cdn.pixabay.com/user/2019/04/11/22-45-05-994_250x250.jpg"},{"id":2295434,"pageURL":"https://pixabay.com/photos/spring-bird-bird-tit-spring-blue-2295434/","type":"photo","tags":"spring bird, bird, tit","previewURL":"https://cdn.pixabay.com/photo/2017/05/08/13/15/spring-bird-2295434_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gf6d745ecd75a8c8fb02dd6d2359b7bc4a01cfcbd711239b2f38972ddf67cf12860f6cf8d0171852bfbf748e2b16e2a5d40c51867231c84c2d6ba8c05d680ded4_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g1e66b6bf8841c797dd8ae071b96f3fed90cfd114769292d9c5c7ac710c806addd7f3c0d85a3a49589c8872aefedccfd2d04f60c845a3bc40afafa593cc0007ed_1280.jpg","imageWidth":5363,"imageHeight":3575,"imageSize":2938651,"views":499965,"downloads":271239,"collections":1924,"likes":1859,"comments":223,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":978659,"pageURL":"https://pixabay.com/photos/lotus-flower-bloom-blossom-978659/","type":"photo","tags":"lotus, flower, bloom","previewURL":"https://cdn.pixabay.com/photo/2015/10/09/00/55/lotus-978659_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g8da00243f4baaa0cb1d3c06a0c4ad6ea8b5d6769edf1d51f2234e72007223c8d2c39bd1dcfacbb5513f96f2f95c8d341_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gd58e0dc9c36397feb02c4628f8137e24922772f4c4acbb6e654ca84fa32f1ef87bdec5dfc3314eba5f3bd4eaa19c72c09bf9354b852cebabed2315ce44332b9f_1280.jpg","imageWidth":3267,"imageHeight":2178,"imageSize":527232,"views":583198,"downloads":296268,"collections":1782,"likes":1792,"comments":294,"user_id":1497331,"user":"jennyzhh2008","userImageURL":"https://cdn.pixabay.com/user/2015/10/08/23-45-39-663_250x250.jpg"},{"id":815270,"pageURL":"https://pixabay.com/photos/sunset-poppies-field-red-poppies-815270/","type":"photo","tags":"sunset, poppies, field","previewURL":"https://cdn.pixabay.com/photo/2015/06/19/20/13/sunset-815270_150.jpg","previewWidth":150,"previewHeight":98,"webformatURL":"https://pixabay.com/get/gb461ee9a220272eaa88e5668802bf42f880d3d4106e9e00c35e3b813f6e8bc4646e9fdc9f03f1687ddfffa6526ce882f_640.jpg","webformatWidth":640,"webformatHeight":422,"largeImageURL":"https://pixabay.com/get/g7424a4b78d17a25e4d58965b5efe445320293253711f9ee488cc55a4d62d606f67beb00ae96188cb456f53a6c3e4649fea36498c7e0a04bb4b2612fe991f49d5_1280.jpg","imageWidth":5147,"imageHeight":3400,"imageSize":2848753,"views":761319,"downloads":397368,"collections":1509,"likes":1906,"comments":415,"user_id":1118992,"user":"diego_torres","userImageURL":"https://cdn.pixabay.com/user/2015/06/18/11-45-50-208_250x250.jpg"},{"id":556718,"pageURL":"https://pixabay.com/photos/magnolia-trees-springtime-556718/","type":"photo","tags":"magnolia trees, springtime, pink flowers","previewURL":"https://cdn.pixabay.com/photo/2014/12/04/14/46/magnolia-trees-556718_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g57c955d49e10e7406491e0b3d9d294dc67c2cfa484bf02c83f26fd0b70960fe29889541f72098be19d6083d3aaa66d62_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g399ee4b3054ae5c887c285719c3a5cba807d0f09edaac4ca05782ac987c83f7a135f480f2357abf36f604f70b52a5c4b78bcb3ad6cf6b32aecb5053c1df052dd_1280.jpg","imageWidth":4272,"imageHeight":2848,"imageSize":3107567,"views":734759,"downloads":324505,"collections":1623,"likes":1751,"comments":377,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":250016,"pageURL":"https://pixabay.com/photos/flower-field-flowers-field-trees-250016/","type":"photo","tags":"flower field, flowers, field","previewURL":"https://cdn.pixabay.com/photo/2014/01/22/19/44/flower-field-250016_150.jpg","previewWidth":150,"previewHeight":108,"webformatURL":"https://pixabay.com/get/gffcb0c5e98f1208cd661ffd4f28ec8b430b292169941af11457367bbc9fe460be1ba7dc27a6e04308be144b63d1a7f74_640.jpg","webformatWidth":640,"webformatHeight":463,"largeImageURL":"https://pixabay.com/get/ga0c2e92160a69e9dbc8b551897d6a39021d5e6eed4440b85394d75158abdf045db4a4b6ae127076788adc3c9a742dd294f8668eaf1e152e2a680afc1648ff45a_1280.jpg","imageWidth":4984,"imageHeight":3607,"imageSize":6895586,"views":847844,"downloads":382716,"collections":1269,"likes":1862,"comments":508,"user_id":37465,"user":"DeltaWorks","userImageURL":"https://cdn.pixabay.com/user/2013/05/31/16-10-34-727_250x250.png"}]}""";
